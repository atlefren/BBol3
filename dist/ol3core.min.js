/*! bbol3 03-12-2014 02:21 */

var bbol3=this.bbol3||{};!function(a){"use strict";a.ConfigParser=function(){function a(a,b){return _.has(a,b)?a[b]:v[b]}function b(b){return new ol.proj.Projection({code:a(b,"srid"),extent:a(b,"extent"),units:a(b,"extentUnits")})}function c(b){var c,d=b.options||{},e={params:_.extend(d,{LAYERS:b.layername,VERSION:b.version}),url:b.url,format:b.format,crossOrigin:"anonymous",transparent:b.transparent};c=b.tiled?new ol.source.TileWMS(e):new ol.source.ImageWMS(e);var f={extent:a(b,"extent"),source:c};return b.tiled?new ol.layer.Tile(f):new ol.layer.Image(f)}function d(a){var b={format:"image/png",version:"1.1.1"};return _.has(a,"tiled")||(a.tiled=!0),_.has(a,"transparent")||(a.transparent=a.isBaseLayer?!1:!0),_.extend({},b,a)}function e(c){function d(a,b){var c=b.getCode();return _.map(_.range(a),function(a){return c+":"+a})}function e(a,b){var c=ol.extent.getWidth(b.getExtent())/256;return _.map(_.range(a),function(a){return c/Math.pow(2,a)})}var f=b(c),g=f.getExtent(),h=v.numZoomLevels,i=e(h,f),j=d(h,f),k=new ol.source.WMTS({url:c.url,layer:c.layername,format:c.format,projection:f,matrixSet:a(c,"srid"),crossOrigin:"anonymous",tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(g),resolutions:i,matrixIds:j})});return new ol.layer.Tile({extent:a(c,"extent"),source:k})}function f(a){var b={format:"image/png"};return _.extend({},b,a)}function g(a){var b={};return _.has(a,"data")&&(b.object=a.data),_.has(a,"url")&&(b.url=a.url),new ol.layer.Vector({source:new ol.source.GeoJSON(b)})}function h(a){var b={};return _.extend({},b,a)}function i(a){if(!_.has(z,a.source))throw'Unsupported source: "'+a.source+'"';var b=z[a.source];a=b.config(a);var c=b.create(a);return _.extend({ollayer:c},a)}function j(a){u.removeLayer(a.ollayer)}function k(a){a.visible=!0,y&&j(y),u.getLayers().insertAt(0,a.ollayer),y=a}function l(a){u.addLayer(a.ollayer)}function m(a){var b=_.range(1,a.numZoomLevels);return _.reduce(b,function(a,b){return a.push(a[b-1]/2),a},[a.maxResolution])}function n(a){var b=_.chain(a.layers).filter(function(a){return a.isBaseLayer}).map(i).value(),c=_.chain(a.layers).filter(function(a){return!a.isBaseLayer}).each(function(a){_.isUndefined(a.visible)&&(a.visible=!0)}).map(i).value();return{baseLayers:b,overlays:c}}function o(a){var b={numZoomLevels:18,maxResolution:21664,extent:[-25e5,35e5,3045984,9045984],center:[-20617,7661666],zoom:2,srid:"EPSG:32633",extentUnits:"m",renderer:"canvas"};return _.extend({},b,a)}function p(a){var b=_.filter(a,function(a){return a.visible});b.length?(k(b[0]),_.chain(b).rest().each(function(a){a.visible=!1})):k(a[0])}function q(a){_.chain(a).filter(function(a){return a.visible}).each(l)}function r(a){v=o(a);var c=m(v),d=b(v);_.isString(w)&&(w=document.getElementById(w)),u=new ol.Map({target:w,renderer:v.renderer,layers:[],view:new ol.View({projection:d,center:v.center,zoom:v.zoom,resolutions:c,maxResolution:v.maxResolution,numZoomLevels:v.numZoomLevels}),overlays:[]});var e=n(v);p(e.baseLayers),q(e.overlays),x&&x(u,e)}function s(a,b){try{b(_.isString(a)?JSON.parse(a):a)}catch(c){$.getJSON(a,function(a){b(a)})}}function t(a,b,c){w=b,x=c,s(a,r)}var u,v,w,x,y,z={WMTS:{config:f,create:e},WMS:{config:d,create:c},GeoJSON:{config:h,create:g}};return{setupMap:t,setBaseLayer:k,addOverlay:l,hideLayer:j}}}(bbol3);
//# sourceMappingURL=ol3core.min.map