/*! bbol3 02-12-2014 01:41 */

var bbol3=this.bbol3||{};!function(a){"use strict";a.ConfigParser=function(){function a(a,b){return _.has(a,b)?a[b]:t[b]}function b(b){return new ol.proj.Projection({code:a(b,"srid"),extent:a(b,"extent"),units:a(b,"extentUnits")})}function c(b){var c,d={params:{LAYERS:b.layername,VERSION:b.version},url:b.url,format:b.format,crossOrigin:"anonymous",transparent:b.transparent};c=b.tiled?new ol.source.TileWMS(d):new ol.source.ImageWMS(d);var e={extent:a(b,"extent"),source:c};return b.tiled?new ol.layer.Tile(e):new ol.layer.Image(e)}function d(a){var b={format:"image/png",transparent:!0,version:"1.1.1"};return _.has(a,"tiled")||(a.tiled=!0),_.extend({},b,a)}function e(c){function d(a,b){var c=b.getCode();return _.map(_.range(a),function(a){return c+":"+a})}function e(a,b){var c=ol.extent.getWidth(b.getExtent())/256;return _.map(_.range(a),function(a){return c/Math.pow(2,a)})}var f=b(c),g=f.getExtent(),h=t.numZoomLevels,i=e(h,f),j=d(h,f),k=new ol.source.WMTS({url:c.url,layer:c.layername,format:c.format,projection:f,matrixSet:a(c,"srid"),crossOrigin:"anonymous",tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(g),resolutions:i,matrixIds:j})});return new ol.layer.Tile({extent:a(c,"extent"),source:k})}function f(a){var b={format:"image/png"};return _.extend({},b,a)}function g(a){if(!_.has(x,a.source))throw'Unsupported source: "'+a.source+'"';var b=x[a.source];a=b.config(a);var c=b.create(a);return _.extend({ollayer:c},a)}function h(a){s.removeLayer(a.ollayer)}function i(a){a.visible=!0,w&&h(w),s.getLayers().insertAt(0,a.ollayer),w=a}function j(a){s.addLayer(a.ollayer)}function k(a){var b=_.range(1,a.numZoomLevels);return _.reduce(b,function(a,b){return a.push(a[b-1]/2),a},[a.maxResolution])}function l(a){var b=_.chain(a.layers).filter(function(a){return a.isBaseLayer}).map(g).value(),c=_.chain(a.layers).filter(function(a){return!a.isBaseLayer}).each(function(a){_.isUndefined(a.visible)&&(a.visible=!0)}).map(g).value();return{baseLayers:b,overlays:c}}function m(a){var b={numZoomLevels:18,maxResolution:21664,extent:[-25e5,35e5,3045984,9045984],center:[-20617,7661666],zoom:2,srid:"EPSG:32633",extentUnits:"m"};return _.extend({},a,b)}function n(a){var b=_.filter(a,function(a){return a.visible});b.length?(i(b[0]),_.chain(b).rest().each(function(a){a.visible=!1})):i(a[0])}function o(a){_.chain(a).filter(function(a){return a.visible}).each(j)}function p(a){t=m(a);var c=k(t),d=b(t);s=new ol.Map({target:u,renderer:a.renderer,layers:[],view:new ol.View({projection:d,center:t.center,zoom:t.zoom,resolutions:c,maxResolution:t.maxResolution,numZoomLevels:t.numZoomLevels}),overlays:[]});var e=l(t);n(e.baseLayers),o(e.overlays),v&&v(s,e)}function q(a,b){try{b(_.isString(a)?JSON.parse(a):a)}catch(c){$.getJSON(a,function(a){b(a)})}}function r(a,b,c){u=b,v=c,q(a,p)}var s,t,u,v,w,x={WMTS:{config:f,create:e},WMS:{config:d,create:c},XYZ:{config:null,create:null},GeoJSON:{config:null,create:null}};return{setupMap:r,setBaseLayer:i,addOverlay:j,hideLayer:h}}}(bbol3);
//# sourceMappingURL=ol3core.min.map