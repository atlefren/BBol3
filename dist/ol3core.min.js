/*! bbol3 02-12-2014 00:59 */

var bbol3=this.bbol3||{};!function(a){"use strict";a.ConfigParser=function(){function a(a,b){return _.has(a,b)?a[b]:r[b]}function b(b){return new ol.proj.Projection({code:a(b,"srid"),extent:a(b,"extent"),units:a(b,"extentUnits")})}function c(b){var c,d={params:{LAYERS:b.layername,VERSION:b.version},url:b.url,format:b.format,crossOrigin:"anonymous",transparent:b.transparent};c=b.tiled?new ol.source.TileWMS(d):new ol.source.ImageWMS(d);var e={extent:a(b,"extent"),source:c};return b.tiled?new ol.layer.Tile(e):new ol.layer.Image(e)}function d(a){var b={format:"image/png",transparent:!0,version:"1.1.1"};return _.has(a,"tiled")||(a.tiled=!0),_.extend({},v,b,a)}function e(c){function d(a,b){var c=b.getCode();return _.map(_.range(a),function(a){return c+":"+a})}function e(a,b){var c=ol.extent.getWidth(b.getExtent())/256;return _.map(_.range(a),function(a){return c/Math.pow(2,a)})}var f=b(c),g=f.getExtent(),h=r.numZoomLevels,i=e(h,f),j=d(h,f),k=new ol.source.WMTS({url:c.url,layer:c.layername,format:c.format,projection:f,matrixSet:a(c,"srid"),crossOrigin:"anonymous",tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(g),resolutions:i,matrixIds:j})});return new ol.layer.Tile({extent:a(c,"extent"),source:k})}function f(a){var b={format:"image/png"};return _.extend({},v,b,a)}function g(a){var b;switch(a.source){case"WMTS":a=f(a),b=e(a);break;case"WMS":a=d(a),b=c(a);break;default:throw"Unsupported source"}return console.log(a.visible),{ollayer:b,name:a.name,visible:a.visible}}function h(a){q.removeLayer(a.ollayer)}function i(a){a.selected=!0,u&&h(u),q.getLayers().insertAt(0,a.ollayer),u=a}function j(a){console.log(a),q.addLayer(a.ollayer)}function k(a){var b=[];b[0]=a.maxResolution;var c;for(c=1;c<a.numZoomLevels;c++)b[c]=b[c-1]/2;return b}function l(a){var b=_.chain(a.layers).filter(function(a){return a.isBaseLayer}).map(g).value(),c=_.chain(a.layers).filter(function(a){return!a.isBaseLayer}).map(g).value();return{baseLayers:b,overlays:c}}function m(a){var b={numZoomLevels:18,maxResolution:21664,extent:[-25e5,35e5,3045984,9045984],center:[-20617,7661666],zoom:2,srid:"EPSG:32633",extentUnits:"m"};return _.extend({},a,b)}function n(a){r=m(a);var c=k(r),d=b(r);q=new ol.Map({target:s,renderer:a.renderer,layers:[],view:new ol.View({projection:d,center:r.center,zoom:r.zoom,resolutions:c,maxResolution:r.maxResolution,numZoomLevels:r.numZoomLevels}),overlays:[]});var e=l(r);i(e.baseLayers[0]),_.chain(e.overlays).filter(function(a){return a.visible}).each(j),t&&t(q,e)}function o(a,b){try{b(_.isString(a)?JSON.parse(a):a)}catch(c){$.getJSON(a,function(a){b(a)})}}function p(a,b,c){s=b,t=c,o(a,n)}var q,r,s,t,u,v={visible:!0};return{setupMap:p,setBaseLayer:i,addOverlay:j,hideLayer:h}}}(bbol3);
//# sourceMappingURL=ol3core.min.map