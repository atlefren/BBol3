/*! bbol3 01-12-2014 01:15 */

var bbol3=this.bbol3||{};!function(a){"use strict";a.ConfigParser=function(){function a(a,b){return _.has(a,b)?a[b]:q[b]}function b(b){return new ol.proj.Projection({code:a(b,"srid"),extent:a(b,"extent"),units:a(b,"extentUnits")})}function c(b){var c,d={params:{LAYERS:b.layername,VERSION:b.version},url:b.url,format:b.format,crossOrigin:"anonymous",transparent:b.transparent};c=b.tiled?new ol.source.TileWMS(d):new ol.source.ImageWMS(d);var e={extent:a(b,"extent"),source:c};return b.tiled?new ol.layer.Tile(e):new ol.layer.Image(e)}function d(a){var b={format:"image/png",transparent:!0,version:"1.1.1"};return _.has(a,"tiled")||(a.tiled=!0),_.extend({},a,b)}function e(c){function d(a,b){var c=b.getCode();return _.map(_.range(a),function(a){return c+":"+a})}function e(a,b){var c=ol.extent.getWidth(b.getExtent())/256;return _.map(_.range(a),function(a){return c/Math.pow(2,a)})}var f=b(c),g=f.getExtent(),h=q.numZoomLevels,i=e(h,f),j=d(h,f),k=new ol.source.WMTS({url:c.url,layer:c.layername,format:c.format,projection:f,matrixSet:a(c,"srid"),crossOrigin:"anonymous",tileGrid:new ol.tilegrid.WMTS({origin:ol.extent.getTopLeft(g),resolutions:i,matrixIds:j})});return new ol.layer.Tile({extent:a(c,"extent"),source:k})}function f(a){var b={format:"image/png"};return _.extend({},a,b)}function g(a){switch(a.source){case"WMTS":return e(f(a));case"WMS":return c(d(a));default:throw"Unsupported source"}}function h(a){p.getLayers().insertAt(0,a)}function i(a){p.addLayer(a)}function j(a){var b=[];b[0]=a.maxResolution;var c;for(c=1;c<a.numZoomLevels;c++)b[c]=b[c-1]/2;return b}function k(a){var b=_.chain(a.layers).filter(function(a){return a.isBaseLayer}).map(g).value(),c=_.chain(a.layers).filter(function(a){return!a.isBaseLayer}).map(g).value();return{baseLayers:b,overlays:c}}function l(a){var b={numZoomLevels:18,maxResolution:21664,extent:[-25e5,35e5,3045984,9045984],center:[-20617,7661666],zoom:2,srid:"EPSG:32633",extentUnits:"m"};return _.extend({},a,b)}function m(a){q=l(a);var c=j(q),d=b(q);p=new ol.Map({target:r,renderer:a.renderer,layers:[],view:new ol.View({projection:d,center:q.center,zoom:q.zoom,resolutions:c,maxResolution:q.maxResolution,numZoomLevels:q.numZoomLevels}),overlays:[]});var e=k(q);_.each(e.baseLayers,h),_.each(e.overlays,i),s&&s(p)}function n(a,b){try{b(_.isString(a)?JSON.parse(a):a)}catch(c){$.getJSON(a,function(a){b(a)})}}function o(a,b,c){r=b,s=c,n(a,m)}var p,q,r,s;return{setupMap:o}}}(bbol3);
//# sourceMappingURL=ol3core.min.map